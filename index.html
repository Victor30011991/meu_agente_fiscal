<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FluxoPro Engine v12</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link id="themeCSS" rel="stylesheet" href="">

<style>
/* =============================================================
   VARIÁVEIS CSS — base clara (padrão)
   Os temas sobrescrevem essas variáveis via themes/*.css
   ============================================================= */
:root {
  --bg:           #f0f2f8;
  --bg2:          #e8eaf2;
  --card:         #ffffff;
  --card-border:  #e2e5ef;
  --header-bg:    #ffffff;
  --header-border:#e2e5ef;
  --text:         #1a1f36;
  --text2:        #6b7280;
  --text-inv:     #ffffff;
  --primary:      #4f46e5;
  --primary-l:    #eef2ff;
  --primary-d:    #3730a3;
  --ok:           #059669;
  --ok-l:         #d1fae5;
  --bad:          #dc2626;
  --bad-l:        #fee2e2;
  --warn:         #d97706;
  --warn-l:       #fef3c7;
  --table-alt:    #f8fafc;
  --table-hover:  #f1f5ff;
  --input-bg:     #f8fafc;
  --input-border: #d1d5db;
  --shadow-sm:    0 1px 3px rgba(0,0,0,.06);
  --shadow:       0 4px 16px rgba(0,0,0,.07);
  --shadow-lg:    0 10px 30px rgba(0,0,0,.10);
  --radius:       14px;
  --radius-sm:    8px;
}

/* =============================================================
   RESET & BASE
   ============================================================= */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: Inter, system-ui, sans-serif;
  font-size: 14px;
  background: var(--bg);
  color: var(--text);
  transition: background .3s, color .3s;
  min-height: 100vh;
}

/* =============================================================
   HEADER
   ============================================================= */
header {
  background: var(--header-bg);
  border-bottom: 1px solid var(--header-border);
  padding: 12px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow-sm);
}

.header-brand {
  display: flex;
  align-items: center;
  gap: 10px;
}
.header-brand .logo {
  width: 32px; height: 32px;
  background: var(--primary);
  border-radius: 8px;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; color: #fff; font-weight: 800;
}
.header-brand h1 {
  font-size: 16px;
  font-weight: 800;
  color: var(--text);
  letter-spacing: -0.3px;
}
.header-brand span {
  font-size: 11px;
  color: var(--text2);
  display: block;
  font-weight: 400;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
}

/* =============================================================
   THEME SELECTOR
   ============================================================= */
.theme-selector {
  display: flex;
  gap: 6px;
  align-items: center;
  background: var(--bg2);
  padding: 4px 8px;
  border-radius: 20px;
  border: 1px solid var(--card-border);
}
.theme-btn {
  width: 22px; height: 22px;
  border-radius: 50%;
  border: 2px solid transparent;
  cursor: pointer;
  transition: transform .2s, box-shadow .2s;
  position: relative;
}
.theme-btn:hover { transform: scale(1.2); }
.theme-btn.active {
  box-shadow: 0 0 0 2px var(--card), 0 0 0 4px var(--primary);
}
.theme-default { background: linear-gradient(135deg, #e0e7ff, #4f46e5); }
.theme-dark    { background: linear-gradient(135deg, #1e293b, #0f172a); }
.theme-emerald { background: linear-gradient(135deg, #a7f3d0, #059669); }
.theme-gold    { background: linear-gradient(135deg, #fde68a, #d97706); }
.theme-indigo  { background: linear-gradient(135deg, #c7d2fe, #4f46e5); }
.theme-rose    { background: linear-gradient(135deg, #fecdd3, #e11d48); }

/* custom color picker dot */
.theme-custom {
  background: conic-gradient(red, yellow, lime, cyan, blue, magenta, red);
  font-size: 0;
}

/* =============================================================
   TABS
   ============================================================= */
.tabs {
  display: flex;
  gap: 4px;
  background: var(--bg2);
  padding: 4px;
  border-radius: 10px;
  border: 1px solid var(--card-border);
}
.tabs button {
  border: none;
  padding: 6px 14px;
  border-radius: 7px;
  cursor: pointer;
  font-weight: 600;
  font-size: 13px;
  background: transparent;
  color: var(--text2);
  transition: all .2s;
}
.tabs button.active {
  background: var(--card);
  color: var(--primary);
  box-shadow: var(--shadow-sm);
}

/* =============================================================
   LAYOUT PRINCIPAL
   ============================================================= */
.container { max-width: 1380px; margin: 0 auto; padding: 24px 20px; }

.layout {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 20px;
  align-items: flex-start;
}

.sidebar {
  position: sticky;
  top: 76px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

@media (max-width: 960px) {
  .layout { grid-template-columns: 1fr; }
  .sidebar { position: relative; top: 0; }
}

/* =============================================================
   CARDS
   ============================================================= */
.card {
  background: var(--card);
  border-radius: var(--radius);
  border: 1px solid var(--card-border);
  box-shadow: var(--shadow);
  transition: background .3s, border-color .3s, box-shadow .2s;
  overflow: hidden;
}
.card-header {
  padding: 16px 20px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}
.card-body { padding: 16px 20px 20px; }
.card-title {
  font-size: 13px;
  font-weight: 700;
  color: var(--text);
  letter-spacing: 0.2px;
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 6px;
}
.card-title .dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--primary);
  display: inline-block;
}

/* =============================================================
   KPI CARDS — resumo geral
   ============================================================= */
.kpi-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
}

@media (max-width: 480px) {
  .kpi-grid { grid-template-columns: 1fr; }
}

.kpi {
  background: var(--card);
  border: 1px solid var(--card-border);
  border-radius: var(--radius-sm);
  padding: 12px 14px;
  text-align: center;
  transition: all .3s;
}
.kpi-label {
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text2);
  margin-bottom: 4px;
}
.kpi-value {
  font-size: 15px;
  font-weight: 800;
  letter-spacing: -0.5px;
  color: var(--text);
}
.kpi-bar {
  height: 3px;
  border-radius: 2px;
  margin-top: 8px;
  background: var(--bg2);
  overflow: hidden;
}
.kpi-bar-fill { height: 100%; border-radius: 2px; transition: width .5s; }

/* =============================================================
   AÇÕES DO SIDEBAR
   ============================================================= */
.sidebar-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 8px;
  padding: 0 20px 20px;
}
.btn-action {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 9px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--card-border);
  background: var(--card);
  color: var(--text);
  font-weight: 600;
  font-size: 12px;
  cursor: pointer;
  transition: all .2s;
}
.btn-action:hover {
  background: var(--primary-l);
  border-color: var(--primary);
  color: var(--primary);
  transform: translateY(-1px);
}

/* =============================================================
   CHART CONTAINERS
   ============================================================= */
.chart-wrap {
  position: relative;
  width: 100%;
  padding: 10px 20px 16px;
}
.chart-note {
  font-size: 11px;
  color: var(--text2);
  padding: 0 20px 14px;
  line-height: 1.5;
}

/* =============================================================
   PAINEL DE LANÇAMENTOS — cabeçalho
   ============================================================= */
.lanc-header {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  margin-bottom: 16px;
}
.btn-new {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 18px;
  border-radius: var(--radius-sm);
  border: none;
  background: var(--primary);
  color: #fff;
  font-weight: 700;
  font-size: 13px;
  cursor: pointer;
  transition: all .2s;
  box-shadow: 0 2px 8px rgba(79,70,229,.3);
}
.btn-new:hover {
  background: var(--primary-d);
  transform: translateY(-1px);
  box-shadow: 0 4px 14px rgba(79,70,229,.4);
}
.btn-sec {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--card-border);
  background: var(--card);
  color: var(--text);
  font-weight: 600;
  font-size: 12px;
  cursor: pointer;
  transition: all .2s;
}
.btn-sec:hover {
  background: var(--primary-l);
  border-color: var(--primary);
  color: var(--primary);
}

/* =============================================================
   FILTROS
   ============================================================= */
.filter-bar {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}
.filter-bar select,
.filter-bar input[type="text"],
.filter-bar input[type="month"] {
  padding: 7px 10px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  font-family: inherit;
  font-size: 13px;
  transition: border-color .2s;
}
.filter-bar select:focus,
.filter-bar input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79,70,229,.1);
}
.filter-search {
  flex: 1;
  min-width: 150px;
  padding-left: 32px !important;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%239ca3af' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 10px center;
}

/* =============================================================
   DADOS DO PERFIL
   ============================================================= */
.perfil-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  padding: 16px 20px 20px;
}
.perfil-field label {
  display: block;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text2);
  margin-bottom: 4px;
}
.perfil-field input {
  width: 100%;
  padding: 8px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  font-family: inherit;
  font-size: 13px;
  font-weight: 500;
  transition: border-color .2s;
}
.perfil-field input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79,70,229,.1);
}

/* =============================================================
   TABELA DE LANÇAMENTOS
   ============================================================= */
.table-wrap { overflow-x: auto; }

table {
  width: 100%;
  border-collapse: collapse;
}
thead tr {
  background: var(--bg2);
}
th {
  padding: 10px 12px;
  text-align: left;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text2);
  white-space: nowrap;
  border-bottom: 1px solid var(--card-border);
}
td {
  padding: 10px 12px;
  border-bottom: 1px solid var(--card-border);
  font-size: 13px;
  color: var(--text);
  vertical-align: middle;
}
tbody tr:last-child td { border-bottom: none; }
tbody tr:nth-child(even) { background: var(--table-alt); }
tbody tr:hover { background: var(--table-hover); }

td[contenteditable] { cursor: text; transition: all .15s; }
td[contenteditable]:focus {
  outline: 2px solid var(--primary);
  outline-offset: -1px;
  background: var(--primary-l);
  border-radius: 4px;
}

.td-data { font-weight: 600; font-size: 12px; color: var(--text2); }
.td-cat  { font-weight: 600; max-width: 140px; }
.td-val  { font-weight: 700; text-align: right; white-space: nowrap; }

/* =============================================================
   BADGES DE TIPO
   ============================================================= */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: 20px;
  font-weight: 700;
  font-size: 11px;
  cursor: pointer;
  transition: all .2s;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  white-space: nowrap;
}
.badge:hover { filter: brightness(.93); transform: scale(1.03); }
.entrada { background: var(--ok-l);  color: var(--ok);  }
.saida   { background: var(--bad-l); color: var(--bad); }

/* dot de cor */
.badge::before {
  content: '';
  width: 6px; height: 6px;
  border-radius: 50%;
  background: currentColor;
}

/* =============================================================
   BOTÃO APAGAR
   ============================================================= */
.btn-del {
  width: 28px; height: 28px;
  border-radius: 6px;
  border: none;
  background: transparent;
  color: var(--text2);
  cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 14px;
  transition: all .2s;
}
.btn-del:hover {
  background: var(--bad-l);
  color: var(--bad);
}

/* =============================================================
   ESTADO VAZIO
   ============================================================= */
.empty-state {
  text-align: center;
  padding: 48px 20px;
  color: var(--text2);
}
.empty-state .empty-icon { font-size: 40px; margin-bottom: 10px; }
.empty-state h3 { font-size: 16px; color: var(--text); margin-bottom: 6px; }
.empty-state p  { font-size: 13px; line-height: 1.6; }

/* =============================================================
   PAGINAÇÃO / CONTAGEM
   ============================================================= */
.table-footer {
  padding: 10px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 12px;
  color: var(--text2);
  border-top: 1px solid var(--card-border);
  background: var(--table-alt);
}

/* =============================================================
   MODAL
   ============================================================= */
.modal {
  position: fixed; inset: 0;
  background: rgba(10,10,20,.45);
  backdrop-filter: blur(4px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  padding: 20px;
}
.modal-box {
  background: var(--card);
  border: 1px solid var(--card-border);
  border-radius: 18px;
  width: 100%;
  max-width: 400px;
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  animation: modalIn .2s ease;
}
@keyframes modalIn {
  from { transform: scale(.94) translateY(10px); opacity: 0; }
  to   { transform: scale(1) translateY(0); opacity: 1; }
}
.modal-header {
  padding: 20px 24px 0;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.modal-header h3 { font-size: 16px; font-weight: 800; color: var(--text); }
.modal-close {
  width: 28px; height: 28px;
  border: none;
  background: var(--bg2);
  border-radius: 6px;
  cursor: pointer;
  color: var(--text2);
  font-size: 16px;
  display: flex; align-items: center; justify-content: center;
  transition: all .2s;
}
.modal-close:hover { background: var(--bad-l); color: var(--bad); }
.modal-body { padding: 20px 24px 24px; }
.form-group { margin-bottom: 14px; }
.form-group label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text2);
  margin-bottom: 5px;
}
.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 9px 12px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--input-border);
  background: var(--input-bg);
  color: var(--text);
  font-family: inherit;
  font-size: 13px;
  transition: border-color .2s;
}
.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79,70,229,.1);
}
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.form-actions { display: flex; gap: 8px; margin-top: 18px; }
.btn-save {
  flex: 1;
  padding: 10px;
  border: none;
  border-radius: var(--radius-sm);
  background: var(--primary);
  color: #fff;
  font-weight: 700;
  font-size: 13px;
  cursor: pointer;
  transition: all .2s;
}
.btn-save:hover { background: var(--primary-d); }
.btn-cancel {
  padding: 10px 16px;
  border: 1px solid var(--card-border);
  border-radius: var(--radius-sm);
  background: var(--card);
  color: var(--text2);
  font-weight: 600;
  font-size: 13px;
  cursor: pointer;
  transition: all .2s;
}
.btn-cancel:hover { background: var(--bg2); }

/* =============================================================
   TOAST
   ============================================================= */
.toast {
  position: fixed;
  bottom: 24px; right: 24px;
  background: var(--text);
  color: var(--text-inv);
  padding: 10px 18px;
  border-radius: 10px;
  font-size: 13px;
  font-weight: 600;
  box-shadow: var(--shadow-lg);
  z-index: 10000;
  animation: toastIn .25s ease;
}
@keyframes toastIn {
  from { transform: translateY(10px) scale(.95); opacity: 0; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}

/* =============================================================
   CONFIGURAÇÕES
   ============================================================= */
.conf-section { padding: 0 20px 20px; }
.conf-title {
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text2);
  margin-bottom: 10px;
}
.conf-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}
.btn-danger {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 9px 14px;
  border: 1px solid #fecaca;
  border-radius: var(--radius-sm);
  background: var(--bad-l);
  color: var(--bad);
  font-weight: 700;
  font-size: 12px;
  cursor: pointer;
  transition: all .2s;
}
.btn-danger:hover { background: var(--bad); color: #fff; }

/* =============================================================
   PICKER DE COR CUSTOMIZADO
   ============================================================= */
.color-picker-wrap {
  position: relative;
  display: inline-flex;
  align-items: center;
}
.color-picker-wrap input[type="color"] {
  position: absolute;
  width: 22px; height: 22px;
  opacity: 0;
  cursor: pointer;
  border: none;
  padding: 0;
}

.hidden { display: none !important; }
</style>
</head>
<body>

<!-- =============================================================
     HEADER
     ============================================================= -->
<header>
  <div class="header-brand">
    <div class="logo">F</div>
    <div>
      <h1>FluxoPro</h1>
      <span>Engine v12 &mdash; Controle financeiro</span>
    </div>
  </div>

  <div class="header-right">

    <!-- Seletor de perfil -->
    <select id="perfilSelect" style="padding:7px 10px;border-radius:8px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--text);font-family:inherit;font-size:13px;font-weight:600"></select>
    <button id="novoPerfil" title="Novo perfil" style="padding:7px 10px;border-radius:8px;border:1px solid var(--input-border);background:var(--input-bg);color:var(--text);font-weight:700;cursor:pointer;font-size:13px">+</button>

    <!-- Tema selector -->
    <div class="theme-selector">
      <button class="theme-btn theme-default active" data-theme="" title="Padrão"></button>
      <button class="theme-btn theme-dark"    data-theme="dark"    title="Dark"></button>
      <button class="theme-btn theme-emerald" data-theme="emerald" title="Emerald"></button>
      <button class="theme-btn theme-gold"    data-theme="gold"    title="Gold"></button>
      <button class="theme-btn theme-indigo"  data-theme="indigo"  title="Indigo"></button>
      <button class="theme-btn theme-rose"    data-theme="rose"    title="Rose"></button>
      <!-- Paleta customizada -->
      <div class="color-picker-wrap" title="Cor personalizada">
        <button class="theme-btn theme-custom" data-theme="custom" title="Personalizado"></button>
        <input type="color" id="colorPicker" value="#4f46e5">
      </div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
      <button data-tab="lanc" class="active">Lançamentos</button>
      <button data-tab="conf">Configurações</button>
    </div>

  </div>
</header>

<!-- =============================================================
     LAYOUT PRINCIPAL
     ============================================================= -->
<div class="container">
<div class="layout">

  <!-- =========================================================
       SIDEBAR — Dashboard
       ========================================================= -->
  <aside class="sidebar">

    <!-- KPIs -->
    <div class="card">
      <div class="card-header" style="padding-bottom:14px">
        <span class="card-title"><span class="dot"></span>Resumo Financeiro</span>
        <span style="font-size:11px;color:var(--text2)" id="periodoLabel"></span>
      </div>
      <div style="padding:0 20px 4px">
        <div class="kpi-grid">
          <div class="kpi">
            <div class="kpi-label">Entradas</div>
            <div class="kpi-value" id="sumEnt" style="color:var(--ok)">R$ 0</div>
            <div class="kpi-bar"><div class="kpi-bar-fill" id="barEnt" style="background:var(--ok);width:0%"></div></div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Saídas</div>
            <div class="kpi-value" id="sumSai" style="color:var(--bad)">R$ 0</div>
            <div class="kpi-bar"><div class="kpi-bar-fill" id="barSai" style="background:var(--bad);width:0%"></div></div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Resultado</div>
            <div class="kpi-value" id="sumRes">R$ 0</div>
            <div class="kpi-bar"><div class="kpi-bar-fill" id="barRes" style="background:var(--primary);width:50%"></div></div>
          </div>
        </div>
      </div>
      <div class="sidebar-actions">
        <button class="btn-action" onclick="abrirExport()">&#128202; Exportar</button>
        <button class="btn-action" onclick="abrirImport()">&#128229; Importar</button>
      </div>
    </div>

    <!-- Gráfico 1 — Distribuição por categoria -->
    <div class="card">
      <div class="card-header">
        <span class="card-title"><span class="dot" style="background:var(--primary)"></span>Por Categoria</span>
      </div>
      <div class="chart-wrap" style="padding-top:14px">
        <canvas id="chartPizza" height="200"></canvas>
      </div>
      <p class="chart-note" id="txtPizza"></p>
    </div>

    <!-- Gráfico 2 — Evolução mensal -->
    <div class="card">
      <div class="card-header">
        <span class="card-title"><span class="dot" style="background:var(--ok)"></span>Evolução Mensal</span>
      </div>
      <div class="chart-wrap" style="padding-top:14px">
        <canvas id="chartEvolucao" height="180"></canvas>
      </div>
      <p class="chart-note" id="txtEvolucao"></p>
    </div>

    <!-- Gráfico 3 — Top categorias (saídas) -->
    <div class="card">
      <div class="card-header">
        <span class="card-title"><span class="dot" style="background:var(--bad)"></span>Top Gastos</span>
      </div>
      <div class="chart-wrap" style="padding-top:14px">
        <canvas id="chartTop" height="180"></canvas>
      </div>
      <p class="chart-note" id="txtTop"></p>
    </div>

  </aside>

  <!-- =========================================================
       MAIN CONTENT
       ========================================================= -->
  <main>

    <!-- =====================================================
         ABA LANÇAMENTOS
         ===================================================== -->
    <section id="tab-lanc">

      <!-- Ações principais -->
      <div class="lanc-header">
        <button class="btn-new" id="novoLanc">&#10133; Novo lançamento</button>
        <button class="btn-sec" id="importar">&#128229; Alimentar perfil</button>
        <button class="btn-sec" id="refreshBtn" title="Atualizar">&#8635; Refresh</button>
      </div>

      <!-- Dados do perfil -->
      <div class="card" style="margin-bottom:16px">
        <div class="card-header" style="padding-bottom:0">
          <span class="card-title"><span class="dot" style="background:var(--warn)"></span>Dados do Perfil</span>
        </div>
        <div class="perfil-grid">
          <div class="perfil-field">
            <label>Nome / Razão social</label>
            <input id="perfilNome" placeholder="Ex: João Silva ou Empresa Ltda.">
          </div>
          <div class="perfil-field">
            <label>CPF ou CNPJ</label>
            <input id="perfilDoc" placeholder="000.000.000-00 ou 00.000.000/0001-00">
          </div>
        </div>
      </div>

      <!-- Tabela -->
      <div class="card">
        <div class="card-header" style="padding-bottom:12px">
          <span class="card-title"><span class="dot"></span>Extrato de Lançamentos</span>
          <span id="totalLanc" style="font-size:12px;color:var(--text2);font-weight:600"></span>
        </div>

        <!-- Filtros -->
        <div style="padding:0 20px 12px">
          <div class="filter-bar">
            <input type="text"  class="filter-search" id="fBusca" placeholder="Buscar por categoria, obs...">
            <select id="fTipo">
              <option value="">Todos os tipos</option>
              <option value="Entrada">Entradas</option>
              <option value="Saida">Saídas</option>
            </select>
            <input type="month" id="fMes" title="Filtrar por mês">
            <button class="btn-sec" id="clearFilter" style="padding:7px 10px;font-size:12px">✕ Limpar</button>
          </div>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th style="width:100px">Data</th>
                <th>Categoria</th>
                <th style="width:100px">Tipo</th>
                <th style="width:110px;text-align:right">Valor</th>
                <th>Observação</th>
                <th style="width:44px"></th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>

        <div class="table-footer" id="tableFooter">
          <span id="footerCount"></span>
          <span id="footerTotal"></span>
        </div>
      </div>

    </section>

    <!-- =====================================================
         ABA CONFIGURAÇÕES
         ===================================================== -->
    <section id="tab-conf" class="hidden">
      <div class="card">
        <div class="card-header" style="padding-bottom:14px">
          <span class="card-title"><span class="dot" style="background:var(--warn)"></span>Painel de Controle</span>
        </div>
        <div class="conf-section">
          <div class="conf-title">Exportação</div>
          <div class="conf-row" style="margin-bottom:20px">
            <button class="btn-sec" id="exportAll">&#128202; Gerar Relatório</button>
          </div>
          <div class="conf-title">Zona de perigo</div>
          <div class="conf-row">
            <button class="btn-danger" id="resetAll">&#128465; Reset de fábrica</button>
          </div>
        </div>
      </div>
    </section>

  </main>
</div>
</div>

<!-- =============================================================
     MODAL — Novo lançamento
     ============================================================= -->
<div class="modal" id="modal">
  <div class="modal-box">
    <div class="modal-header">
      <h3>Novo Lançamento</h3>
      <button class="modal-close" onclick="fecharModal()">&#10005;</button>
    </div>
    <div class="modal-body">
      <form id="form">
        <div class="form-row">
          <div class="form-group">
            <label>Data</label>
            <input type="date" id="data" required>
          </div>
          <div class="form-group">
            <label>Tipo</label>
            <select id="tipo">
              <option>Entrada</option>
              <option>Saída</option>
            </select>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Categoria</label>
            <input type="text" id="cat" placeholder="Ex: Salário, Aluguel..." required>
          </div>
          <div class="form-group">
            <label>Valor (R$)</label>
            <input type="text" id="valor" placeholder="Ex: 1.500,00" required>
          </div>
        </div>
        <div class="form-group">
          <label>Observação (opcional)</label>
          <textarea id="obs" placeholder="Detalhes do lançamento..." rows="2"></textarea>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn-save">&#128190; Salvar</button>
          <button type="button" class="btn-cancel" onclick="fecharModal()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
/* =============================================================
   CONSTANTES & ESTADO
   ============================================================= */
const KEY = "fluxopro_v12";
let charts = {};
let debounceTimer;
let filterState = { busca: "", tipo: "", mes: "" };

/* =============================================================
   PERSISTÊNCIA
   ============================================================= */
function loadDB() {
  return JSON.parse(localStorage.getItem(KEY)) || {
    active: "default",
    profiles: { default: [] },
    profileInfo: {},
    theme: "",
    customColor: "#4f46e5"
  };
}
function saveDB(db) { localStorage.setItem(KEY, JSON.stringify(db)); }

/* =============================================================
   FORMATADORES
   ============================================================= */
function formatMoney(v) {
  return new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(v || 0);
}
function normalizeValue(v) {
  let s = String(v || "").replace(/[^\d.,-]/g, "").replace(",", ".");
  let n = parseFloat(s);
  return isNaN(n) ? null : Math.abs(n);
}
function list() {
  const db = loadDB();
  return db.profiles[db.active] || [];
}

/* =============================================================
   FILTROS
   ============================================================= */
function applyFilters(dados) {
  return dados.filter(i => {
    const busca = filterState.busca.toLowerCase();
    if (busca && !(i.cat||"").toLowerCase().includes(busca) && !(i.obs||"").toLowerCase().includes(busca)) return false;
    if (filterState.tipo) {
      const t = filterState.tipo === "Saida" ? "Saída" : filterState.tipo;
      if (i.tipo !== t) return false;
    }
    if (filterState.mes && i.data && !i.data.startsWith(filterState.mes)) return false;
    return true;
  });
}

/* =============================================================
   RENDERIZAR PERFIS
   ============================================================= */
function renderPerfis() {
  const db = loadDB();
  perfilSelect.innerHTML = Object.keys(db.profiles).map(p =>
    `<option ${p === db.active ? "selected" : ""}>${p}</option>`
  ).join("");
}

function renderProfileInfo() {
  const db = loadDB();
  const info = db.profileInfo[db.active] || {};
  perfilNome.value = info.nome || "";
  perfilDoc.value  = info.doc  || "";
}

function saveProfileInfo() {
  const db = loadDB();
  if (!db.profileInfo) db.profileInfo = {};
  db.profileInfo[db.active] = {
    nome: perfilNome.value.trim(),
    doc:  perfilDoc.value.trim()
  };
  saveDB(db);
}

/* =============================================================
   RENDERIZAR TABELA
   ============================================================= */
function renderTable() {
  const todos    = list();
  const filtrado = applyFilters(todos);

  if (!filtrado.length) {
    tbody.innerHTML = `
      <tr><td colspan="6">
        <div class="empty-state">
          <div class="empty-icon">&#128193;</div>
          <h3>${todos.length ? "Nenhum resultado para o filtro aplicado" : "Nenhum lançamento cadastrado"}</h3>
          <p>${todos.length ? "Tente outros termos ou limpe o filtro." : "Clique em \"Novo lançamento\" para começar."}</p>
        </div>
      </td></tr>`;
    document.getElementById("footerCount").innerText = "";
    document.getElementById("footerTotal").innerText = "";
    document.getElementById("totalLanc").innerText   = "";
    return;
  }

  let totEnt = 0, totSai = 0;
  tbody.innerHTML = filtrado.map(i => {
    if (i.tipo === "Entrada") totEnt += i.valor;
    else totSai += i.valor;
    return `
    <tr data-id="${i.id}">
      <td class="td-data" contenteditable data-f="data">${i.data || ""}</td>
      <td class="td-cat"  contenteditable data-f="cat">${i.cat || ""}</td>
      <td><span class="badge ${i.tipo === "Entrada" ? "entrada" : "saida"} btnTipo">${i.tipo}</span></td>
      <td class="td-val"  contenteditable data-f="valor">${formatMoney(i.valor)}</td>
      <td contenteditable data-f="obs" style="color:var(--text2);max-width:200px;overflow:hidden;text-overflow:ellipsis">${i.obs || ""}</td>
      <td><button class="btn-del del" title="Apagar">&#128465;</button></td>
    </tr>`;
  }).join("");

  const net = totEnt - totSai;
  document.getElementById("footerCount").innerText = `${filtrado.length} lançamento${filtrado.length !== 1 ? "s" : ""}`;
  document.getElementById("footerTotal").innerText = `Resultado filtrado: ${formatMoney(net)}`;
  document.getElementById("totalLanc").innerText   = `${todos.length} total`;
}

/* =============================================================
   RESUMO KPIs
   ============================================================= */
function updateResumo() {
  let e = 0, s = 0;
  list().forEach(i => i.tipo === "Entrada" ? e += i.valor : s += i.valor);
  const net = e - s;
  const max = Math.max(e, s, 1);

  sumEnt.innerText = formatMoney(e);
  sumSai.innerText = formatMoney(s);
  sumRes.innerText = formatMoney(net);
  sumRes.style.color = net >= 0 ? "var(--ok)" : "var(--bad)";

  document.getElementById("barEnt").style.width = (e / max * 100).toFixed(1) + "%";
  document.getElementById("barSai").style.width = (s / max * 100).toFixed(1) + "%";
  document.getElementById("barRes").style.width = Math.min(100, (Math.abs(net) / max * 100)).toFixed(1) + "%";
  document.getElementById("barRes").style.background = net >= 0 ? "var(--primary)" : "var(--bad)";

  const d = list();
  if (d.length) {
    const datas = d.map(i => i.data).filter(Boolean).sort();
    document.getElementById("periodoLabel").innerText = datas[0] + " — " + datas[datas.length - 1];
  } else {
    document.getElementById("periodoLabel").innerText = "";
  }
}

/* =============================================================
   CORES DOS GRÁFICOS
   ============================================================= */
const PALETTE_MULTI = [
  "#4f46e5","#059669","#dc2626","#d97706","#7c3aed",
  "#db2777","#0891b2","#65a30d","#ea580c","#2563eb"
];

function getChartDefaults() {
  return {
    font: { family: "Inter, sans-serif", size: 11 },
    color: getComputedStyle(document.documentElement).getPropertyValue("--text2").trim() || "#6b7280"
  };
}

/* =============================================================
   GRÁFICOS
   ============================================================= */
function buildMonthlyData(dados) {
  const map = {};
  dados.forEach(i => {
    if (!i.data) return;
    const mes = i.data.substring(0, 7); // YYYY-MM
    if (!map[mes]) map[mes] = { ent: 0, sai: 0 };
    i.tipo === "Entrada" ? map[mes].ent += i.valor : map[mes].sai += i.valor;
  });
  const keys = Object.keys(map).sort();
  return {
    labels: keys.map(k => {
      const [y, m] = k.split("-");
      return new Date(y, m - 1).toLocaleDateString("pt-BR", { month: "short", year: "2-digit" });
    }),
    ent: keys.map(k => map[k].ent),
    sai: keys.map(k => map[k].sai)
  };
}

function renderDashboard() {
  const dados = list();
  const textColor = getComputedStyle(document.documentElement).getPropertyValue("--text2").trim() || "#6b7280";
  const gridColor = getComputedStyle(document.documentElement).getPropertyValue("--card-border").trim() || "#e2e5ef";

  const baseOptions = {
    responsive: true,
    maintainAspectRatio: true,
    plugins: {
      legend: { labels: { font: { family: "Inter", size: 11 }, color: textColor, boxWidth: 12, padding: 12 } },
      tooltip: { bodyFont: { family: "Inter", size: 12 }, callbacks: {
        label: ctx => " " + formatMoney(ctx.parsed.y ?? ctx.parsed ?? 0)
      }}
    }
  };

  if (!dados.length) {
    ["pizza","evolucao","top"].forEach(k => { if (charts[k]) { charts[k].destroy(); delete charts[k]; }});
    txtPizza.innerText = txtEvolucao.innerText = txtTop.innerText = "Adicione lançamentos para ver os gráficos.";
    return;
  }

  /* --- GRÁFICO 1 — Donut categorias saídas --- */
  const mapacat = {};
  let totalSai = 0;
  dados.forEach(i => {
    if (i.tipo !== "Entrada") {
      mapacat[i.cat || "Outros"] = (mapacat[i.cat || "Outros"] || 0) + i.valor;
      totalSai += i.valor;
    }
  });
  const catLabels = Object.keys(mapacat);
  const catVals   = Object.values(mapacat);

  if (charts.pizza) { charts.pizza.destroy(); }
  charts.pizza = new Chart(chartPizza, {
    type: "doughnut",
    data: {
      labels: catLabels,
      datasets: [{
        data: catVals,
        backgroundColor: PALETTE_MULTI.slice(0, catLabels.length),
        borderWidth: 0,
        hoverOffset: 8
      }]
    },
    options: {
      ...baseOptions,
      cutout: "68%",
      plugins: {
        ...baseOptions.plugins,
        legend: { position: "bottom", labels: { ...baseOptions.plugins.legend.labels } },
        tooltip: { callbacks: {
          label: ctx => ` ${ctx.label}: ${formatMoney(ctx.parsed)} (${(ctx.parsed / totalSai * 100).toFixed(1)}%)`
        }}
      }
    }
  });

  const topCat = catLabels.reduce((a, k) => mapacat[k] > (mapacat[a] || 0) ? k : a, catLabels[0] || "");
  txtPizza.innerText = totalSai ? `Maior gasto: ${topCat} (${formatMoney(mapacat[topCat] || 0)})` : "";

  /* --- GRÁFICO 2 — Linha evolução mensal --- */
  const monthly = buildMonthlyData(dados);

  if (charts.evolucao) { charts.evolucao.destroy(); }
  charts.evolucao = new Chart(chartEvolucao, {
    type: "line",
    data: {
      labels: monthly.labels,
      datasets: [
        {
          label: "Entradas",
          data: monthly.ent,
          borderColor: "#059669",
          backgroundColor: "rgba(5,150,105,.08)",
          fill: true,
          tension: .4,
          pointRadius: 4,
          pointBackgroundColor: "#059669",
          borderWidth: 2
        },
        {
          label: "Saídas",
          data: monthly.sai,
          borderColor: "#dc2626",
          backgroundColor: "rgba(220,38,38,.07)",
          fill: true,
          tension: .4,
          pointRadius: 4,
          pointBackgroundColor: "#dc2626",
          borderWidth: 2
        }
      ]
    },
    options: {
      ...baseOptions,
      interaction: { mode: "index", intersect: false },
      scales: {
        x: { grid: { color: gridColor }, ticks: { color: textColor, font: { family: "Inter", size: 10 } } },
        y: { grid: { color: gridColor }, ticks: { color: textColor, font: { family: "Inter", size: 10 },
          callback: v => "R$ " + (v >= 1000 ? (v / 1000).toFixed(1) + "k" : v)
        }, beginAtZero: true }
      },
      plugins: { ...baseOptions.plugins, legend: { position: "top", labels: { ...baseOptions.plugins.legend.labels } } }
    }
  });

  const meses = monthly.labels.length;
  txtEvolucao.innerText = meses ? `${meses} mês${meses !== 1 ? "es" : ""} no período` : "";

  /* --- GRÁFICO 3 — Barras horizontais top categorias --- */
  const topEntries = Object.entries(mapacat).sort((a, b) => b[1] - a[1]).slice(0, 6);
  const topLabels  = topEntries.map(e => e[0]);
  const topVals    = topEntries.map(e => e[1]);

  if (charts.top) { charts.top.destroy(); }
  charts.top = new Chart(chartTop, {
    type: "bar",
    data: {
      labels: topLabels,
      datasets: [{
        label: "Saídas por categoria",
        data: topVals,
        backgroundColor: PALETTE_MULTI.slice(0, topLabels.length).map(c => c + "cc"),
        borderColor:     PALETTE_MULTI.slice(0, topLabels.length),
        borderWidth: 2,
        borderRadius: 6
      }]
    },
    options: {
      ...baseOptions,
      indexAxis: "y",
      scales: {
        x: { grid: { color: gridColor }, ticks: { color: textColor, font: { family: "Inter", size: 10 },
          callback: v => "R$ " + (v >= 1000 ? (v / 1000).toFixed(1) + "k" : v)
        }, beginAtZero: true },
        y: { grid: { display: false }, ticks: { color: textColor, font: { family: "Inter", size: 11, weight: "600" } } }
      },
      plugins: { ...baseOptions.plugins, legend: { display: false } }
    }
  });

  txtTop.innerText = topLabels.length ? `${topLabels.length} categoria${topLabels.length !== 1 ? "s" : ""} com saídas` : "";
}

/* =============================================================
   REFRESH GERAL
   ============================================================= */
function refreshAll() {
  renderTable();
  updateResumo();
  renderProfileInfo();
  renderDashboard();
}

/* =============================================================
   TOAST
   ============================================================= */
function showToast(msg) {
  const t = document.createElement("div");
  t.className = "toast";
  t.innerText = msg;
  document.body.appendChild(t);
  setTimeout(() => t.remove(), 2200);
}

/* =============================================================
   FORMULÁRIO — salvar lançamento
   ============================================================= */
form.onsubmit = e => {
  e.preventDefault();
  const v = normalizeValue(valor.value);
  if (v === null) return alert("Valor inválido. Use: 1500 ou 1.500,00");
  const db = loadDB();
  db.profiles[db.active].push({
    id: crypto.randomUUID(),
    data: data.value,
    cat:  cat.value.trim(),
    tipo: tipo.value,
    valor: v,
    obs:  obs.value.trim()
  });
  saveDB(db);
  fecharModal();
  form.reset();
  refreshAll();
  showToast("Lançamento adicionado!");
};

function fecharModal() { modal.style.display = "none"; }
modal.onclick = e => { if (e.target === modal) fecharModal(); };
novoLanc.onclick = () => {
  data.value = new Date().toISOString().split("T")[0];
  modal.style.display = "flex";
};

/* =============================================================
   TABELA — cliques (apagar, toggle tipo)
   ============================================================= */
tbody.onclick = e => {
  const tr = e.target.closest("tr");
  if (!tr || !tr.dataset.id) return;
  const db   = loadDB();
  const item = db.profiles[db.active].find(i => i.id === tr.dataset.id);
  if (!item) return;

  if (e.target.closest(".del")) {
    if (confirm("Apagar este lançamento?")) {
      db.profiles[db.active] = db.profiles[db.active].filter(i => i.id !== item.id);
      saveDB(db); refreshAll();
      showToast("Lançamento removido");
    }
    return;
  }

  if (e.target.classList.contains("btnTipo")) {
    item.tipo = item.tipo === "Entrada" ? "Saída" : "Entrada";
    saveDB(db); refreshAll();
  }
};

/* =============================================================
   CONTENTEDITABLE — debounce
   ============================================================= */
tbody.addEventListener("blur", e => {
  const td = e.target;
  if (!td.dataset.f) return;
  const tr   = td.closest("tr");
  const db   = loadDB();
  const item = db.profiles[db.active].find(i => i.id === tr.dataset.id);
  if (!item) return;
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(() => {
    if (td.dataset.f === "valor") {
      const n = normalizeValue(td.innerText);
      if (n === null) { td.innerText = formatMoney(item.valor); alert("Valor inválido"); return; }
      item.valor = n;
    } else {
      item[td.dataset.f] = td.innerText.trim();
    }
    saveDB(db); refreshAll();
    showToast("Alteração salva");
  }, 350);
}, true);

/* =============================================================
   FILTROS
   ============================================================= */
fBusca.oninput   = () => { filterState.busca = fBusca.value.trim();   renderTable(); };
fTipo.onchange   = () => { filterState.tipo  = fTipo.value;           renderTable(); };
fMes.onchange    = () => { filterState.mes   = fMes.value;            renderTable(); };
clearFilter.onclick = () => {
  fBusca.value = ""; fTipo.value = ""; fMes.value = "";
  filterState = { busca: "", tipo: "", mes: "" };
  renderTable();
};

/* =============================================================
   PERFIL
   ============================================================= */
perfilNome.onblur = saveProfileInfo;
perfilDoc.onblur  = saveProfileInfo;

perfilSelect.onchange = e => {
  const db = loadDB();
  db.active = e.target.value;
  saveDB(db); refreshAll();
  showToast("Perfil: " + e.target.value);
};

novoPerfil.onclick = () => {
  const n = prompt("Nome do novo perfil:");
  if (!n || !n.trim()) return;
  const db = loadDB();
  if (db.profiles[n]) { alert("Perfil já existe!"); return; }
  db.profiles[n]    = [];
  db.profileInfo[n] = {};
  db.active = n;
  saveDB(db);
  renderPerfis(); refreshAll();
  showToast("Perfil criado: " + n);
};

/* =============================================================
   TABS
   ============================================================= */
document.querySelectorAll(".tabs button").forEach(b => {
  b.onclick = () => {
    document.querySelectorAll(".tabs button").forEach(x => x.classList.remove("active"));
    b.classList.add("active");
    document.querySelectorAll("main section").forEach(s => s.classList.add("hidden"));
    document.getElementById("tab-" + b.dataset.tab).classList.remove("hidden");
  };
});

/* =============================================================
   IMPORTAR / EXPORTAR
   ============================================================= */
function abrirImport() {
  window.open("import.html?perfil=" + encodeURIComponent(loadDB().active), "_blank");
}
function abrirExport() { window.open("export.html", "_blank"); }

importar.onclick  = abrirImport;
exportAll.onclick = abrirExport;

/* =============================================================
   RESET
   ============================================================= */
resetAll.onclick = () => {
  if (confirm("Apagar TODOS os dados? Esta ação não pode ser desfeita!")) {
    if (confirm("Tem certeza absoluta? Todos os perfis serão perdidos!")) {
      localStorage.removeItem(KEY);
      location.reload();
    }
  }
};

/* =============================================================
   SISTEMA DE TEMAS — CSS variables
   ============================================================= */
function applyCustomColor(hex) {
  const r = parseInt(hex.slice(1, 3), 16);
  const g = parseInt(hex.slice(3, 5), 16);
  const b = parseInt(hex.slice(5, 7), 16);
  // Gera variante clara da cor
  const lightHex = "#" + [r, g, b].map(c => Math.round(c + (255 - c) * .85).toString(16).padStart(2, "0")).join("");
  const darkHex  = "#" + [r, g, b].map(c => Math.round(c * .7).toString(16).padStart(2, "0")).join("");

  document.documentElement.style.setProperty("--primary",   hex);
  document.documentElement.style.setProperty("--primary-l", lightHex);
  document.documentElement.style.setProperty("--primary-d", darkHex);
}

document.querySelectorAll(".theme-btn").forEach(btn => {
  btn.onclick = () => {
    const theme = btn.dataset.theme;
    const db = loadDB();
    db.theme = theme;
    saveDB(db);

    document.querySelectorAll(".theme-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    // Remover override de cor customizada ao trocar tema
    document.documentElement.style.removeProperty("--primary");
    document.documentElement.style.removeProperty("--primary-l");
    document.documentElement.style.removeProperty("--primary-d");

    themeCSS.href = (theme && theme !== "custom") ? "themes/" + theme + ".css" : "";
    showToast("Tema: " + (theme || "Padrão"));
    setTimeout(renderDashboard, 50); // Re-render com cores do tema
  };
});

// Cor personalizada via color picker
colorPicker.oninput = e => {
  const hex = e.target.value;
  const db  = loadDB();
  db.customColor = hex;
  db.theme = "custom";
  saveDB(db);

  themeCSS.href = "";
  document.querySelectorAll(".theme-btn").forEach(b => b.classList.remove("active"));
  document.querySelector(".theme-custom").classList.add("active");
  applyCustomColor(hex);
  setTimeout(renderDashboard, 50);
};

function loadTheme() {
  const db    = loadDB();
  const theme = db.theme || "";
  if (theme && theme !== "custom") {
    themeCSS.href = "themes/" + theme + ".css";
    document.querySelector(".theme-btn[data-theme='" + theme + "']")?.classList.add("active");
    document.querySelector(".theme-btn[data-theme='']")?.classList.remove("active");
  } else if (theme === "custom" && db.customColor) {
    colorPicker.value = db.customColor;
    document.querySelector(".theme-custom")?.classList.add("active");
    document.querySelector(".theme-btn[data-theme='']")?.classList.remove("active");
    applyCustomColor(db.customColor);
  }
}

/* =============================================================
   INICIALIZAÇÃO
   ============================================================= */
(function init() {
  const db = loadDB();
  saveDB(db);
  loadTheme();
  renderPerfis();
  refreshAll();
})();
</script>
</body>
</html>
