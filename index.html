<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FluxoPro Engine v12</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<link id="themeCSS" rel="stylesheet" href="">

<style>
/* (estilos exatamente iguais ao seu arquivo original) */
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui;background:#f5f7fb;color:#1f2937;transition:background .3s, color .3s}
:root{--p:#4f46e5;--card:#fff;--b:#e5e7eb;--ok:#10b981;--bad:#ef4444}
header{background:#fff;border-bottom:1px solid var(--b);padding:14px 20px;display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
.tabs button{border:none;padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:700;background:#f3f4f6;transition:all .2s}
.tabs button.active{background:var(--p);color:#fff}
.container{max-width:1300px;margin:auto;padding:20px}
.layout{display:grid;grid-template-columns:340px 1fr;gap:20px;align-items:flex-start;}
.sidebar{position:sticky;top:20px;}
@media(max-width:900px){
  .layout{grid-template-columns:1fr}
  .sidebar{position:relative}
}
.card{background:var(--card);border-radius:18px;padding:20px;border:1px solid var(--b);margin-bottom:20px;box-shadow:0 10px 20px rgba(0,0,0,.04);transition:all .3s}
table{width:100%;border-collapse:collapse}
th,td{padding:12px 10px;border-bottom:1px solid var(--b)}
td[contenteditable]{cursor:text;transition:all .2s}
td[contenteditable]:focus{outline:2px solid var(--p);background:#eef2ff}
.badge{padding:6px 12px;border-radius:999px;font-weight:700;cursor:pointer;display:inline-block;transition:all .2s}
.entrada{background:#ecfdf5;color:var(--ok)}
.saida{background:#fef2f2;color:var(--bad)}
button{border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer;transition:all .2s}
button:hover{opacity:.8;transform:translateY(-1px)}
.main{background:var(--p);color:#fff}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px}
select,input,textarea{padding:8px 10px;border-radius:10px;border:1px solid var(--b);font-family:inherit}
.resume{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;margin-bottom:10px}
.resume div{background:#f9fafb;border-radius:12px;padding:12px;font-weight:700;text-align:center}
.gridDash{display:grid;grid-template-columns:1fr;gap:16px;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:9999}
.modal .card{max-width:380px;width:90%;margin:0}
.hidden{display:none}

/* seletor de temas */
.theme-selector{display:flex;gap:8px;align-items:center}
.theme-btn{width:28px;height:28px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all .2s}
.theme-btn:hover{transform:scale(1.1)}
.theme-btn.active{border-color:#000;box-shadow:0 0 0 2px #fff}
.theme-default{background:linear-gradient(135deg,#f5f7fb,#4f46e5)}
.theme-dark{background:#0f172a}
.theme-emerald{background:#10b981}
.theme-gold{background:#f59e0b}
.theme-indigo{background:#6366f1}
.theme-rose{background:#fb7185}

.loading{display:inline-block;width:16px;height:16px;border:3px solid #fff;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

.toast{position:fixed;bottom:20px;right:20px;background:#1f2937;color:#fff;padding:12px 20px;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,.3);z-index:10000;animation:slideIn .3s}
@keyframes slideIn{from{transform:translateX(400px);opacity:0}}
</style>
</head>
<body>

<!-- (HTML exatamente igual ao seu original â€“ nÃ£o alterei nenhuma tag) -->

<!-- ... -->
<!-- TODO O HTML DA SUA MENSAGEM ORIGINAL PERMANECE IGUAL -->
<!-- ... -->

<script>
/* ======================
   TODO O SEU SCRIPT ORIGINAL
   (sem nenhuma modificaÃ§Ã£o)
====================== */

const KEY="fluxopro_v12";
let charts={};
let debounceTimer;

/* (todo o seu cÃ³digo exatamente igual ao que vocÃª colou) */

/* ===================================================
   SISTEMA DE TEMAS
   (clique permanece igual)
=================================================== */

document.querySelectorAll(".theme-btn").forEach(btn=>{
  btn.onclick=()=>{
    const theme=btn.dataset.theme;
    const db=loadDB();
    db.theme=theme;
    saveDB(db);

    document.querySelectorAll(".theme-btn").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");

    if(theme){
      themeCSS.href=`themes/${theme}.css`;
    }else{
      themeCSS.href="";
    }

    showToast(`ðŸŽ¨ Tema: ${theme||"PadrÃ£o"}`);
  };
});

/* ===================================================
   ðŸ”§ FUNÃ‡ÃƒO CORRIGIDA
=================================================== */

function loadTheme(){

  const db = loadDB();
  const theme = db.theme || "";

  document
    .querySelectorAll(".theme-btn")
    .forEach(b => b.classList.remove("active"));

  if(theme){
    themeCSS.href = `themes/${theme}.css`;

    document
      .querySelector(`.theme-btn[data-theme="${theme}"]`)
      ?.classList.add("active");

  }else{
    themeCSS.href = "";

    document
      .querySelector('.theme-btn[data-theme=""]')
      ?.classList.add("active");
  }
}

/* inicializaÃ§Ã£o (igual ao seu) */
(function init(){
  const db=loadDB();
  saveDB(db);
  loadTheme();
  renderPerfis();
  refreshAll();
})();

modal.onclick=e=>{
  if(e.target===modal)fecharModal();
};
</script>

</body>
</html>
