<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>FluxoPro – Importar</title>
</head>

<body>

<div class="container">
  <h1>Importar lançamentos</h1>
  <input type="file" id="fileInput">
  <button onclick="importar()">Importar</button>
</div>

<script>
const KEY="fluxopro_v12";
const params=new URLSearchParams(location.search);
const perfil=params.get("perfil");

function importar(){
  const fileInput=document.getElementById("fileInput");
  const file=fileInput.files[0];
  if(!file){ alert("Selecione um arquivo"); return; }
  const reader=new FileReader();
  reader.onload=e=>{
    try{
      const dados=JSON.parse(e.target.result);
      const db=JSON.parse(localStorage.getItem(KEY));
      db.profiles[perfil]=db.profiles[perfil].concat(dados);
      localStorage.setItem(KEY,JSON.stringify(db));
      alert("Importado com sucesso!");
    }catch{
      alert("Arquivo inválido");
    }
  };
  reader.readAsText(file);
}
</script>

</body>
</html>
